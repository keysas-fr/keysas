

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Decontamination station for USB devices &mdash; Keysas v2.7 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/css/colors.css?v=b89d75b9" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=b896f718"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Keysas-admin application" href="keysas-admin.html" />
    <link rel="prev" title="Download" href="download.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Keysas
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#software-dependencies">Software dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#getting-keysas">Getting <strong>Keysas</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#clamav-configuration">Clamav configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#system-wide-installation">System wide installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#cross-compiling-for-rpi4">Cross compiling for RPi4</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#building-keysas-frontend">Building <strong>Keysas-frontend</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#building-keysas-admin">Building <strong>Keysas-admin</strong></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="networkgw.html">Network gateway (keysas-core)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="administration.html">Administration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="administration.html#design">Design</a></li>
<li class="toctree-l3"><a class="reference internal" href="administration.html#system-configuration">System configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="administration.html#recommendations">Recommendations</a></li>
<li class="toctree-l4"><a class="reference internal" href="administration.html#keysas-in">keysas-in</a></li>
<li class="toctree-l4"><a class="reference internal" href="administration.html#keysas-transit">keysas-transit</a></li>
<li class="toctree-l4"><a class="reference internal" href="administration.html#keysas-out">keysas-out</a></li>
<li class="toctree-l4"><a class="reference internal" href="administration.html#systemd-unit-files">Systemd unit files</a></li>
<li class="toctree-l4"><a class="reference internal" href="administration.html#apparmor">Apparmor</a></li>
<li class="toctree-l4"><a class="reference internal" href="administration.html#libyara-analysis">Libyara analysis</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="usage.html">Usage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="usage.html#from-the-untrusted-network">From the untrusted network</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage.html#from-the-trusted-network">From the trusted network</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="download.html">Download</a><ul>
<li class="toctree-l3"><a class="reference internal" href="download.html#lastest-release">Lastest release</a><ul>
<li class="toctree-l4"><a class="reference internal" href="download.html#keysas-v2-6">Keysas v2.6</a></li>
<li class="toctree-l4"><a class="reference internal" href="download.html#keysas-v2-5">Keysas v2.5</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Decontamination station for USB devices</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#download">Download</a></li>
<li class="toctree-l2"><a class="reference internal" href="#keysas-admin-desktop-client">Keysas-admin (Desktop client)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fido2-authentication">Fido2 Authentication</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#enabling-the-feature">Enabling the Feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="#initialisation-de-la-yubikey">Initialisation de la Yubikey</a></li>
<li class="toctree-l3"><a class="reference internal" href="#yubikey-initialization">YubiKey Initialization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#revoking-a-yubikey">Revoking a YubiKey</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#using-the-keysas-station">Using the Keysas Station</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hardening">Hardening</a></li>
<li class="toctree-l2"><a class="reference internal" href="#required-hardware-to-build-on-raspberry-pi">Required Hardware to build on Raspberry Pi</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="keysas-admin.html">Keysas-admin application</a><ul>
<li class="toctree-l2"><a class="reference internal" href="keysas-admin.html#ssh-configuration">SSH configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="keysas-admin.html#generate-a-ikpqpki">Generate a IKPQPKI</a></li>
<li class="toctree-l2"><a class="reference internal" href="keysas-admin.html#enroll-you-keysas-stations">Enroll you Keysas stations</a></li>
<li class="toctree-l2"><a class="reference internal" href="keysas-admin.html#sign-your-outgoing-usb-keys">Sign your outgoing USB keys</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="windows_firewall.html">Windows USB firewall</a><ul>
<li class="toctree-l2"><a class="reference internal" href="windows_firewall.html#architecture">Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="windows_firewall.html#security-policy-configuration">Security Policy configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="windows_firewall.html#installation">Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="windows_firewall.html#driver-compilation">Driver compilation</a></li>
<li class="toctree-l3"><a class="reference internal" href="windows_firewall.html#installer-creation">Installer creation</a></li>
<li class="toctree-l3"><a class="reference internal" href="windows_firewall.html#service-and-application-compilation">Service and application compilation</a></li>
<li class="toctree-l3"><a class="reference internal" href="windows_firewall.html#todo-list">TODO List</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Keysas</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Decontamination station for USB devices</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/raspberry.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="decontamination-station-for-usb-devices">
<h1>Decontamination station for USB devices<a class="headerlink" href="#decontamination-station-for-usb-devices" title="Link to this heading"></a></h1>
<p>This is a 100% open-source decontamination station you can build on Debian 12 (or Debian 13) for both architecture (x86_64 or aarch64).</p>
<p>Keysas software offers antivirus scanning as well as analysis based on +20000 pre-installed Yara rules.
You can add new Yara rules as desired to increase the detection probability.
You can also filter the types and maximum size of files to transfer as output.
The code is entirely written in Rust, sandboxed, and follows the principle of least privilege.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Despite the care taken in the solution, there may still be some bugs during use.
Please don’t hesitate to contact us to report any bugs, which will be addressed in future versions.</p>
</div>
<section id="download">
<h2>Download<a class="headerlink" href="#download" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/keysas-fr/keysas/releases">Github/releases</a></p></li>
</ul>
<p>Before getting started, you need to sign at least one output USB device (which will receive files considered safe). All unsigned USB storage devices will be considered default input devices (potentially containing malicious files).</p>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>The output USB devices that you need to sign will be completely destroyed (MBR/Partitions, etc.) and rebuilt according to a specific model. There is no support for GPT partition tables at the moment.</p>
</div>
</section>
<section id="keysas-admin-desktop-client">
<h2>Keysas-admin (Desktop client)<a class="headerlink" href="#keysas-admin-desktop-client" title="Link to this heading"></a></h2>
<p>The administration of Keysas stations, the signing, and revocation of output USB devices are greatly facilitated by using the keysas-admin application.
It allows you to register your Keysas stations and manage them from an administration workstation.</p>
<p>Currently, only GNU/Linux administration workstations are supported. The downloads are available in the download section above.</p>
<p>To provide you with maximum security, the keysas-admin application is developed using the Tauri-app framework and exclusively uses Vue-JS 3 for the frontend and Rust language for the backend.</p>
<p>The administration of <strong>Keysas</strong> stations works using the SSHv2 protocol.
Therefore, you need to generate a dedicated pair of ed25519 asymmetric keys for Keysas station administration.
To do this, open a terminal and enter the following command:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="go">ssh-keygen -m PEM -t ed25519 -f mykey</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The application currently does not support passphrase management or the PKCS#12 format.
Therefore, you need to enter an empty passphrase by pressing Enter.
Similarly, the enrollment and revocation features of Yubikeys are not supported by the application yet.</p>
</div>
<p>Once the key pair is generated, open the application and go to the <strong>SSH configuration</strong> tab.
Enter the path to your public key and private key, and then validate.
Finally, add your new Keysas station in the <strong>Add a new Keysas</strong> menu by retrieving the IP address displayed on your <strong>Keysas</strong> station.
Then click on Manage your Keysas in the menu.
Your new station should now appear there.
Start by exporting your SSH public key by clicking on <strong>Export SSH pubkey</strong>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>You must export your public key before using other available features. Otherwise, they will not work.</p>
</div>
<p>Once the SSH public key is exported, password-based SSH authentication will be disabled. You will need to authenticate using the SSH key pair previously created.</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="go">ssh -i myprivatekey keysas@192.168.XX.YY (IP obtained via DHCP)</span>
</pre></div>
</div>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>During the first connection, before exporting the SSH public key, the default password is <strong>Changeme007</strong>.</p>
</div>
</section>
<section id="fido2-authentication">
<h2>Fido2 Authentication<a class="headerlink" href="#fido2-authentication" title="Link to this heading"></a></h2>
<p>By default, the <strong>Keysas</strong> station accepts transfers from any input devices. However, it is now possible for the administrator to configure the station to enforce user authentication using FIDO2.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently, only YubiKey 5 and 5c are supported for FIDO2 authentication. Support for other FIDO2-compatible keys will be added soon.</p>
</div>
<section id="enabling-the-feature">
<h3>Enabling the Feature<a class="headerlink" href="#enabling-the-feature" title="Link to this heading"></a></h3>
<p>To activate the authentication feature, you need to connect to the <strong>Keysas</strong> station as a superadministrator.
Please note that if you have exported your SSH public key using the “keysas-admin” application, password authentication is disabled.
Therefore, you should connect using your private key.</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="go">ssh -i mykey keysas@192.168.XX.YY (IP obtenue via DHCP)</span>
</pre></div>
</div>
<p>Next, modify the configuration of the <strong>keysas-io</strong> system daemon:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="go">sudo vim /etc/systemd/system/keysas-io.service</span>
</pre></div>
</div>
<p>Add the option -y true après ExecStart=/usr/bin/keysas-io, as follows:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="go">ExecStart=/usr/bin/keysas-io -y</span>
</pre></div>
</div>
<p>Reload the daemon configuration:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="go">sudo systemctl daemon-reload</span>
</pre></div>
</div>
<p>Finally, restart the station to apply the configuration changes:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="go">sudo shutdown -r now</span>
</pre></div>
</div>
<p>The <strong>Keysas</strong> station will now only accept transfers from authenticated users.</p>
</section>
<section id="initialisation-de-la-yubikey">
<h3>Initialisation de la Yubikey<a class="headerlink" href="#initialisation-de-la-yubikey" title="Link to this heading"></a></h3>
<p>Connect a YubiKey 5 to the station to configure it. Use the “keysas” account to perform this step:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="go">sudo /usr/bin/keysas-manage-yubikey -i</span>
</pre></div>
</div>
<p>Please note that slot 2 of the YubiKey will be modified.</p>
</section>
<section id="yubikey-initialization">
<h3>YubiKey Initialization<a class="headerlink" href="#yubikey-initialization" title="Link to this heading"></a></h3>
<p>Connect a YubiKey 5 to the <strong>Keysas</strong> station to configure it. Use the “keysas-sign” account to perform this step:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="go">sudo /usr/bin/keysas-manage-yubikey -e -n Jean</span>
</pre></div>
</div>
<p>Replace “John” with the name of the FIDO2 user. Modify it according to your needs.
Now, the FIDO2 key is ready for use.</p>
</section>
<section id="revoking-a-yubikey">
<h3>Revoking a YubiKey<a class="headerlink" href="#revoking-a-yubikey" title="Link to this heading"></a></h3>
<p>If you ever need to revoke a YubiKey, simply connect it to the <strong>Keysas</strong> station and proceed as follows:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="go">sudo /usr/bin/keysas-manage-yubikey -r true</span>
</pre></div>
</div>
<p>The YubiKey will start flashing. Press the button to confirm the revocation.</p>
</section>
</section>
<section id="using-the-keysas-station">
<h2>Using the Keysas Station<a class="headerlink" href="#using-the-keysas-station" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>In the top-right menu, you can find the status of the <strong>Keysas</strong> station as well as help ;</p></li>
<li><p>If FIDO2 authentication is enabled, insert a registered YubiKey first ;</p></li>
<li><p>Connect an input device (Any unsigned USB device should be recognized as an input device) ;</p></li>
<li><p>If FIDO2 authentication is enabled, the YubiKey icon on the screen will turn green, and the button on the YubiKey should start blinking. Press the button to confirm the authentication ;</p></li>
<li><p>Follow the on-screen instructions. Once the files start appearing in the output SAS, disconnect the input device ;</p></li>
<li><p>Connect the signed output device after disconnecting the input device. ;</p></li>
</ul>
<p>All configuration files are located in /etc/keysas/keysas-<a href="#id1"><span class="problematic" id="id2">*</span></a>.conf.
It is possible to control a whitelist of file types (magic numbers) and set the maximum file size for transfer. Please refer to the official Keysas documentation for more information on the available options (<a class="reference external" href="https://keysas.fr/administration.html#keysas-transit">https://keysas.fr/administration.html#keysas-transit</a>).</p>
</section>
<section id="hardening">
<h2>Hardening<a class="headerlink" href="#hardening" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Unsigned devices mounted as read-only (RO), NODEV, NOSUID, NOEXEC, NODEV.</p></li>
<li><p><strong>Keysas</strong> unprivileged daemons sandboxed using Seccomp, Landlock, Namespaces, AppArmor.</p></li>
</ul>
<p>For each transferred file, depending on the results of various scans, you may find the following extensions:</p>
<ul class="simple">
<li><p>.krp: Keysas report, contains various information about the scan</p></li>
<li><p>.ioerror: the file has been corrupted (incomplete copy or disc full);</p></li>
</ul>
</section>
<section id="required-hardware-to-build-on-raspberry-pi">
<h2>Required Hardware to build on Raspberry Pi<a class="headerlink" href="#required-hardware-to-build-on-raspberry-pi" title="Link to this heading"></a></h2>
<p><a class="reference external" href="https://www.raspberrypi.com/products/raspberry-pi-touch-display/">Official screen.</a></p>
<p><a class="reference external" href="https://www.raspberrypi.com/products/raspberry-pi-4-model-b/?variant=raspberry-pi-4-model-b-8gb">Raspberry Pi 4 8Go RAM / model B.</a></p>
<p><a class="reference external" href="https://www.raspberrypi.com/products/type-c-power-supply/">Power supply.</a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>No data is or will be collected during your use of the <strong>Keysas</strong> station.</p>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="download.html" class="btn btn-neutral float-left" title="Download" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="keysas-admin.html" class="btn btn-neutral float-right" title="Keysas-admin application" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020-2025, Stephane N.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>